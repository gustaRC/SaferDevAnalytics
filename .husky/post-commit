BRANCH_NAME=$(git rev-parse --abbrev-ref HEAD)
COMMIT_MSG=$(git log -1 --pretty=%B)

if [[ "$BRANCH_NAME" == "master" || "$BRANCH_NAME" == "main" ]] && ! [[ "$COMMIT_MSG" =~ ^chore\(release\): ]]; then
  echo "."
  echo "."
  echo "--- Post-COMMIT - Husky üê∂"
  echo "--- Processando CHANGELOG.md e Vers√£o..."
  echo "."
  echo "."

  npm run release_test

  read -p "Deseja confirmar o versionamento e CHANGELOG autom√°tico? (s/N): " confirm
  if [[ "$confirm" =~ ^[Ss]$ ]]; then
    npm run release
    git push --follow-tags origin main
  else
    echo "Versionamento e CHANGELOG autom√°tico cancelado!"
  fi

fi
